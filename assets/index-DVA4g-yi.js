(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const c=document.querySelector(".js-toggle-theme"),h=document.querySelector("body");c.addEventListener("click",()=>{h.getAttribute("data-theme")==="dark"?(h.setAttribute("data-theme","light"),c.classList.remove("dark")):(h.setAttribute("data-theme","dark"),c.classList.add("dark"))});class g{constructor(e,t={}){if(this.root=e,!this.root)throw new Error("MonthCalendar: root not found");this.opts={date:new Date,locale:"ru-RU",...t},this.titleEl=this.root.querySelector(".calendar__title"),this.gridEl=this.root.querySelector(".calendar__grid"),this.current=new Date(this.opts.date.getFullYear(),this.opts.date.getMonth(),1),this.startDay=null,this.endDay=null,this.render(),this.attachEvents()}render(){const e=this.current.getFullYear(),t=this.current.getMonth(),a=this.#e(e,t),n=new Intl.DateTimeFormat(this.opts.locale,{month:"long"}).format(this.current);this.titleEl.textContent=n.charAt(0).toUpperCase()+n.slice(1);const l=new Date(e,t,1),o=this.#a(l),D=Math.ceil((o+a)/7)*7-(o+a);this.gridEl.innerHTML="";const u=t===0?11:t-1,f=t===0?e-1:e,m=this.#e(f,u);for(let r=o;r>0;r--){const d=document.createElement("li");d.className="calendar__day calendar__day--inactive";const i=document.createElement("span");i.classList.add("calendar__day-nr"),i.textContent=m-r+1,d.appendChild(i),d.dataset.date=this.#t(f,u,m-r+1),this.gridEl.appendChild(d)}for(let r=1;r<=a;r++){const d=document.createElement("li");d.className="calendar__day";const i=document.createElement("span");i.classList.add("calendar__day-nr"),i.textContent=r,d.appendChild(i),d.dataset.date=this.#t(e,t,r),this.gridEl.appendChild(d)}for(let r=1;r<=D;r++){const d=document.createElement("li");d.className="calendar__day calendar__day--inactive";const i=document.createElement("span");i.classList.add("calendar__day-nr"),i.textContent=r,d.appendChild(i);const p=t===11?0:t+1,_=t===11?e+1:e;d.dataset.date=this.#t(_,p,r),this.gridEl.appendChild(d)}this.updateSelection()}attachEvents(){this.gridEl.addEventListener("click",e=>{const t=e.target.closest(".calendar__day");if(!t||!t.dataset.date)return;const a=t.dataset.date;this.startDay&&!this.endDay&&this.startDay===a?(this.startDay=null,this.endDay=null):this.startDay&&this.endDay&&this.startDay===a?(this.startDay=this.endDay,this.endDay=null):this.endDay===a?this.endDay=null:!this.startDay||this.startDay&&this.endDay?(this.startDay=a,this.endDay=null):this.startDay&&!this.endDay&&(a>=this.startDay?this.endDay=a:(this.endDay=this.startDay,this.startDay=a)),this.updateSelection()})}updateSelection(){this.gridEl.querySelectorAll(".calendar__day").forEach(t=>{const a=t.dataset.date;t.classList.remove("calendar__day--selected","calendar__day--start","calendar__day--end","calendar__day--single"),this.startDay&&this.endDay?(a>=this.startDay&&a<=this.endDay&&t.classList.add("calendar__day--selected"),a===this.startDay&&t.classList.add("calendar__day--start"),a===this.endDay&&t.classList.add("calendar__day--end")):this.startDay&&!this.endDay&&a===this.startDay&&t.classList.add("calendar__day--single")})}#e(e,t){return new Date(e,t+1,0).getDate()}#a(e){return(e.getDay()+6)%7}#t(e,t,a){return new Date(e,t,a).toISOString().slice(0,10)}}document.addEventListener("DOMContentLoaded",()=>{new g(document.querySelector(".calendar"))});
